<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Folgas e Lembretes BAGAM</title>
  <link rel="icon" type="image/png" href="Fotos Colaboradores/unnamed.png">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&family=Montserrat:wght@700&display=swap" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <style>
    html {
      scroll-behavior: smooth;
    }

    .member-card { overflow: visible; } /* garantir que confetes saiam do card */
    .member-card.birthday-today {
      animation: pulse-card 1.2s infinite;
      border: 4px solid #ffd54f !important;
      transform: translateY(-6px);
      box-shadow: 0 12px 30px rgba(255,193,7,0.16), 0 6px 18px rgba(33,134,67,0.08);
      position: relative;
      z-index: 2;
    }

    /* pulse */
    @keyframes pulse-card {
      0% {
        box-shadow: 0 0 0 0 rgba(255, 193, 7, 0.527);
      }
      12.5% {
        box-shadow: 0 0 30px 8px rgba(244, 67, 54, 0.616); /* vermelho */
      }
      25% {
        box-shadow: 0 0 30px 8px rgba(255, 153, 0, 0.664); /* laranja */
      }
      37.5% {
        box-shadow: 0 0 30px 8px rgba(255, 235, 59, 0.664); /* amarelo */
      }
      50% {
        box-shadow: 0 0 30px 8px rgba(76, 175, 79, 0.678); /* verde */
      }
      62.5% {
        box-shadow: 0 0 30px 8px rgba(33, 149, 243, 0.644); /* azul */
      }
      75% {
        box-shadow: 0 0 30px 8px rgba(104, 58, 183, 0.603); /* roxo */
      }
      87.5% {
        box-shadow: 0 0 30px 8px rgba(233, 30, 98, 0.623); /* rosa */
      }
      100% {
        box-shadow: 0 0 0 0 rgba(255, 193, 7, 0.479);
      }
    }

    /* confete pieces */
    .confetti {
      position: absolute;
      left: 0;
      top: 0;
      pointer-events: none;
      z-index: 9999;
      will-change: transform, opacity;
      display: inline-block;
      line-height: 1;
      font-size: var(--em-size, 22px);
      transform-origin: center;
      filter: drop-shadow(0 3px 6px rgba(0,0,0,0.12));
      /* animação mais suave, sem rotações */
      animation: confetti-explode var(--dur, 1600ms) cubic-bezier(.0,.6,.2,0) both;
      animation-delay: var(--delay, 5ms);
      background: transparent;
      user-select: none;
      opacity: 0;
    }

    /* explosão suave de dentro para fora — sem giro */
    @keyframes confetti-explode {
      0% {
        transform: translate(0,0) scale(0.18);
        opacity: 0;
      }
      12% {
        transform: translate(calc(var(--dx) * 0.12), calc(var(--dy) * 0.12)) scale(1.04);
        opacity: 1;
      }
      35% {
        transform: translate(calc(var(--dx) * 0.45), calc(var(--dy) * 0.45)) scale(1.00);
        opacity: 1;
      }
      70% {
        transform: translate(calc(var(--dx) * 0.85), calc(var(--dy) * 0.85)) scale(0.98);
        opacity: 0.75;
      }
      100% {
        transform: translate(var(--dx), var(--dy)) scale(0.96);
        opacity: 0;
      }
    }
    .calendar-day.today {
      border: 3px solid #dd4a06 !important;
      box-shadow: 0 0 16px 2px #dd4a06, 0 0 0 px #dd4a06 inset;
      animation: pulse-today 1.2s infinite alternate;
      position: relative;
    }

    .calendar-day.conflict-event {
        /* Metade feriado, metade aniversário */
        background: linear-gradient(
          to right,
          var(--holiday-bg) 0 50%,
          #fff7c1 50% 100%
        ) !important;
        border: 2px solid var(--holiday-border); /* Nacional */
        color: var(--holiday-txt);
        position: relative;
      }
      .calendar-day.conflict-event.local-holiday{
        /* Metade municipal, metade aniversário */
        background: linear-gradient(
          to right,
          #1976d2 0 50%,
          #ef6c00 50% 100%
        ) !important;
        border: 2px solid #89b3dd; /* Municipal */
        color: #fff;
      }
      .calendar-day.conflict-event .fa-birthday-cake {
        position: absolute;
        left: 7px;
        top: 7px;
        font-size: 1.1em;
        color: #ef6c00;
        z-index: 2;
      }
      .calendar-day.conflict-event .fa-calendar-day,
      .calendar-day.conflict-event .fa-holiday {
        position: absolute;
        right: 7px;
        top: 7px;
        font-size: 1.1em;
        color: inherit;
        z-index: 2;
      }

    .conflict {
      color:var(--conflict-txt)!important;font-weight:bold;background:var(--conflict-bg)!important;
      padding:7px 13px;border-radius:6px;font-size:1.08rem;margin-bottom:7px;border:2px solid #d81c1c;
      box-shadow:0 1px 8px #ffebee;display:flex;align-items:center;gap:8px;text-align:center;justify-content:center;width:95%;
    }
    .conflict-sector {
      color:#856404!important;background:#ffefc7!important;border-color:#ffc107!important;font-weight:bold;
      padding:7px 13px;border-radius:6px;font-size:1.08rem;margin-bottom:7px;border:2px solid #ffc107;
      box-shadow:0 1px 8px #fffbe6;display:flex;align-items:center;gap:8px;text-align:center;justify-content:center;width:95%;
    }
      .calendar-day.local-holiday {
      background: #1976d2 !important;
      color: #fff !important;
      border: 2px solid #89b3dd !important;
      font-weight: bold;
      box-shadow: 0 2px 10px #90caf9;
    }
    .calendar-day.local-holiday::after {
      content: "\f133";
      font-family: "Font Awesome 6 Free";
      font-weight: 900;
      position: absolute;
      right: 7px;
      top: 7px;
      font-size: 1.1em;
      color: #fff;
    }
      :root {
        --primary: #03642c; --secondary: #047562; --accent: #38d397;
        --card-bg: #fff; --card-radius: 16px; --shadow: 0 6px 24px rgba(0, 0, 0, 0.377);
        --header-font: 'Montserrat', 'Poppins', sans-serif; --body-font: 'Poppins', sans-serif;
        --border: 1px solid #e6e6e6; --conflict-bg: #ffe3e3; --conflict-txt: #d81c1c;
        --holiday-bg: #ffd6d6; --holiday-border: #d81c1c; --holiday-txt: #b30000;
        --tooltip-bg: #218355; --tooltip-txt: #fff; --tooltip-radius: 8px;
      }
      body {
        font-family: var(--body-font);
        /* background:linear-gradient(135deg,var(--primary),var(--secondary)); */
        background-image: url('https://i.postimg.cc/fLLNZ3w1/Whats-App-Image-2025-08-21-at-18-08-59.jpg');
        background-size: cover;
        background-position: center center;
        background-repeat: no-repeat;
        background-attachment: fixed;
        margin:0;
        padding:0;
        color:#202a25;
        position: relative;
      }
      body::before {
        content: "";
        position: fixed;
        top: 0; left: 0; width: 100vw; height: 100vh;
        background: rgba(33, 134, 67, 0.70); /* verde translúcido, ajuste o alpha se quiser */
        pointer-events: none;
        z-index: 0;
      }
      .container, header.topbar, .calendar-container, section, footer {
        position: relative;
        z-index: 1;
      }
      h1 {font-family:var(--header-font);font-size:2.8rem;font-weight:900;letter-spacing:.5px;margin:28px 0 24px 0;border-bottom:4px solid var(--accent);padding-bottom:6px;color:#ffffff;text-align:center;}
      h2 {font-family:var(--header-font);font-weight:700;font-size:1.6rem;margin:28px 0 16px 0;color:var(--accent);}
      .filters {display:flex;gap:30px;margin:24px 0 30px 0;flex-wrap:wrap;background:rgba(255,255,255,.22);border-radius:14px;padding:18px 26px;align-items:center;border:2px solid var(--accent);justify-content:center;box-shadow:0 2px 12px rgba(33,134,67,.09);}
      .filters label {font-family:var(--header-font);font-weight:700;color:var(--primary);display:flex;align-items:center;gap:7px;font-size:1.18rem;}
      .filters select {border-radius:8px;border:2px solid var(--accent);padding:8px 18px;font-size:1.08rem;background:#f8fbf7;font-family:var(--body-font);box-shadow:0 2px 10px #38d3973d;outline:none;transition:border .2s;}
      .filters select:focus {border-color:var(--secondary);}
      .calendar-container {background:rgba(33,134,67,.95);border-radius:18px;padding:35px 28px;box-shadow:var(--shadow);margin-bottom:38px;max-width:700px;margin-left:auto;margin-right:auto;border:2px solid var(--accent);}
      .calendar-header {display:flex;justify-content:center;align-items:center;margin-bottom:18px;gap:10px;}
      .calendar-header h2 {flex:1;margin:0;color:#fff;text-align:center;}
      .calendar-grid {display:grid;grid-template-columns:repeat(7,1fr);gap:7px;text-align:center;margin-top:5px;}
      .calendar-day {padding:13px 0;border-radius:7px;background:#f8f9fa;font-weight:500;font-size:1.1rem;transition:background .2s;border:1px solid #e6e6e6;position:relative;cursor:pointer;}
      .calendar-day.header {background:var(--accent);color:#fff;font-weight:bold;font-size:1.05rem;border:none;}
      .calendar-day.birthday {background:#fff7c1;border:2px solid #ef6c00;font-weight:bold;color:#ef6c00;box-shadow:0 2px 10px #ffe9b4;}
      .calendar-day.birthday::after {content:"\f1fd";font-family:"Font Awesome 6 Free";font-weight:900;position:absolute;right:7px;top:7px;font-size:1.1em;color:#ef6c00;}
      .calendar-day.holiday {background:var(--holiday-bg);border:2px solid var(--holiday-border);color:var(--holiday-txt);font-weight:bold;box-shadow:0 2px 10px #ffd6d6;}
      .calendar-day.holiday::after {content:"\f133";font-family:"Font Awesome 6 Free";font-weight:900;position:absolute;right:7px;top:7px;font-size:1.1em;color:var(--holiday-txt);}
      .calendar-day.empty {background:transparent;border:none;box-shadow:none;}
      /* Tooltip estilizado */
      .calendar-tooltip {
        display:none;
        position:absolute;
        left:50%;
        top:-38px;
        transform:translateX(-50%);
        background:var(--tooltip-bg);
        color:var(--tooltip-txt);
        padding:7px 12px;
        border-radius:var(--tooltip-radius);
        font-size:.75rem;
        font-family:var(--body-font);
        white-space:nowrap;
        z-index:10;
        box-shadow:0 2px 8px rgba(34, 34, 34, 0.533);
        opacity:0;
        pointer-events:none;
        transition:opacity .14s,top .14s;
      }
      .calendar-day:hover .calendar-tooltip,
      .calendar-day:focus .calendar-tooltip {
        display:block;
        opacity:1;
        top:-45px;
      }
      @media (max-width:600px) {
        .calendar-tooltip {font-size:.92rem;top:-50px;}
      }
      section {
    scroll-margin-top: 90px; /* ajuste conforme altura do header */
  }
      section {background:rgba(255,255,255,.11);border-radius:13px;padding:20px 14px 36px 14px;margin-bottom:32px;box-shadow:var(--shadow);border:1.5px solid var(--accent);}
      .team-container {display:flex;flex-wrap:wrap;gap:30px;justify-content:center;}
      .member-card {background:var(--card-bg);border-radius:var(--card-radius);padding:28px 18px 24px 18px;width:260px;box-shadow:0 4px 20px rgba(33,134,67,.14);margin-bottom:20px;display:flex;flex-direction:column;align-items:center;border:2.5px solid var(--accent);transition:transform .16s,box-shadow .16s;}
      .member-card:hover {transform:translateY(-7px) scale(1.04);box-shadow:0 10px 32px rgba(33,134,67,.17);border-color:#047562;}
      .member-photo {width:110px;height:110px;object-fit:cover;border-radius:50%;margin-bottom:16px;border:4px solid var(--accent);box-shadow:0 2px 14px #eefbe9;background:#eefbe9;}
      .member-card h3 {font-family:var(--header-font);font-weight:700;font-size:1.18rem;color:var(--primary);margin-bottom:6px;margin-top:2px;}
      .member-card p {font-size:1rem;margin:2px 0 7px 0;color:#303d31;font-weight:500;text-align:center;}
      .member-card .fa-plane-departure {color:#047562;margin-right:5px;}
      .member-card .fa-birthday-cake {color:#ef6c00;margin-right:5px;}
      .member-card .fa-user {color:var(--accent);font-size:1.25em;margin-bottom:5px;}
      .conflict {color:var(--conflict-txt)!important;font-weight:bold;background:var(--conflict-bg)!important;padding:7px 13px;border-radius:6px;font-size:1.08rem;margin-bottom:7px;border:2px solid #d81c1c;box-shadow:0 1px 8px #ffebee;display:flex;align-items:center;gap:8px;text-align:center;justify-content:center;width:95%;}
      .member-card .fa-exclamation-triangle {color:#d81c1c;}
      @media (max-width:700px) {.container{padding:10px;}.calendar-container{padding:18px 7px;max-width:97vw;}.team-container{flex-direction:column;align-items:center;}.member-card{width:99vw;padding:16px;}h1{font-size:2.1rem;}}
      .btn-custom {background:var(--accent);color:#fff;border:none;border-radius:6px;font-weight:600;font-size:1.1rem;padding:9px 21px;transition:background .18s;box-shadow:0 2px 10px #38d3973d;display:inline-flex;align-items:center;gap:8px;}
      .btn-custom:hover,.btn-custom:focus {background:#047562;color:#fff;outline:none;}
      header.topbar {position:fixed;top:0;left:0;width:100%;background:#fff;border-bottom:2px solid var(--accent);z-index:1000;display:flex;align-items:center;justify-content:space-between;padding:10px 32px;}
      header.topbar .logo {height:38px;margin-right:16px;}
      header.topbar nav a {margin:0 16px;color:var(--primary);font-family:var(--header-font);font-weight:600;text-decoration:none;transition:color .2s;}
      header.topbar nav a:hover {color:var(--accent);}
      .dark-mode {background:#222 !important;color:#fff;}
      .dark-mode .calendar-container, .dark-mode section {background:#333 !important;color:#fff;}
      .dark-mode h1,.dark-mode h2 {color:#38d397 !important;}
      .dark-mode .member-card {background:#222;color:#fff;}
      .dark-mode .filters {background:#2a2a2a;}
      .dark-mode .filters label {color:#38d397;}
      .dark-mode .filters select {background:#222;color:#fff;border-color:#38d397;}
      .dark-toggle {background:var(--accent);color:#fff;border:none;border-radius:50%;width:38px;height:38px;font-size:1.35rem;display:flex;align-items:center;justify-content:center;cursor:pointer;position:fixed;right:30px;bottom:30px;z-index:1100;}
      footer {text-align:center;padding:18px 0;color:#fff;background:linear-gradient(90deg,var(--primary),var(--accent));border-radius:12px;margin-top:30px;}
      
      
    </style>
</head>

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-9632JZPJ3P"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-9632JZPJ3P');
</script>
  
<body>

  <header class="topbar">
    <div>
      <img src="https://i.postimg.cc/NG3dNtxk/Vibra-logo.png" alt="Logo" class="logo">  
    </div>
   
    <nav>
  <a href="#folga-list-section"><i class="fas fa-bed"></i> Folgas</a>
  <a href="#lembrete-list-section"><i class="fas fa-bell"></i> Lembretes</a>
</nav>
    <button id="filter-btn" class="btn btn-custom" style="margin-left:18px;"><i class="fas fa-filter"></i> Filtrar</button>
<div id="filter-panel" style="display:none;position:absolute;top:60px;right:40px;z-index:2000;background:#fff;border-radius:12px;box-shadow:0 4px 18px #0002;padding:22px 28px;min-width:320px;">
  <h4 style="margin-bottom:18px;">Filtrar colaboradores</h4>
  <div style="display:flex;flex-direction:column;gap:14px;">
    <label>Setor:
      <select id="filter-setor" class="form-select">
        <option value="">Todos</option>
      </select>
    </label>
    <label>Nome:
      <input type="text" id="filter-nome" class="form-control" placeholder="Digite o nome">
    </label>
    <label>
      <input type="checkbox" id="filter-folgas"> Mostrar apenas quem está de folga no mês
    </label>
    <button id="filter-aplicar" class="btn btn-success mt-2"><i class="fas fa-search"></i> Aplicar filtro</button>
    <button id="filter-fechar" class="btn btn-secondary mt-1"><i class="fas fa-times"></i> Fechar</button>
    <button id="filter-limpar" class="btn btn-outline-secondary mt-1"><i class="fas fa-undo"></i> Limpar filtro</button>
  </div>
  <div id="filter-resultado" style="margin-top:18px;"></div>
</div>
  </header>
  <div class="container" style="padding-top:80px;">
    <h1 class="text-center">Folgas e Lembretes BAGAM</h1>
    <div class="filters">
      <label><i class="fas fa-calendar-alt" style="color: #ffffff;"></i> Mês: <select id="month-select"></select></label>
      <label><i class="fas fa-calendar" style="color: #ffffff;"></i> Ano: <select id="year-select"></select></label>
    </div>
    
    <!-- Legenda do calendário -->
<div class="calendar-legend" style="margin-bottom:14px; display:flex; gap:20px; flex-wrap:wrap; align-items:center; justify-content: center" >
  <span style="display:flex;align-items:center;gap:7px;">
    <span style="display:inline-block; width:22px; height:22px; border-radius:7px; background:#ffd6d6; border:2px solid #d81c1c; margin-right:4px;"></span>
    <span > <h5 style="margin-top: 20px; margin-bottom: 20px; color: white;">Feriado Nacional</h5></span>
  </span>
  <span style="display:flex;align-items:center;gap:7px;">
    <span style="display:inline-block; width:22px; height:22px; border-radius:7px; background:#1976d2; border:2px solid #89b3dd; margin-right:4px;"></span>
    <span> <h5 style="margin-top: 20px; margin-bottom: 20px; color: white;">Feriado Municipal e Estadual </h5></span>
  </span>
  <span style="display:flex;align-items:center;gap:7px;">
    <span style="display:inline-block; width:22px; height:22px; border-radius:7px; background:#fff7c1; border:2px solid #ef6c00; margin-right:4px;"></span>
    <span><h5 style="margin-top: 20px; margin-bottom: 20px; color: white;">Folga ou Lembrete</h5></span>
  </span>
  
  </span>
</div>
    
    <div class="calendar-container">
      <div class="calendar-header">
        <button class="btn btn-custom me-2" id="prev-month"><i class="fas fa-chevron-left"></i> Anterior</button>
        <h2 id="calendar-title"></h2>
        <button class="btn btn-custom ms-2" id="next-month">Próximo <i class="fas fa-chevron-right"></i></button>
      </div>
      <div class="calendar-grid" id="calendar-grid"></div>
    </div>
    <section id="folga-list-section">
      <h2 style="color: #ffffff;"><i class="fas fa-bed"></i> Colaboradores de folga no mês</h2>
      <div id="folga-list" class="team-container"></div>
      <div style="text-align: center; margin-top: 20px;">
        <button id="add-folga-btn" class="btn btn-custom"><i class="fas fa-plus"></i> Adicionar Folga</button>
      </div>
    </section>
    <section id="lembrete-list-section">
     
      <h2 style="color: #ffffff;"><i class="fas fa-bell"></i> Lembretes do mês</h2>
      <div id="lembrete-list" class="team-container"></div>
      <div style="text-align: center; margin-top: 20px;">
        <button id="add-lembrete-btn" class="btn btn-custom"><i class="fas fa-plus"></i> Adicionar Lembrete</button>
      </div>
  
    </section>
  </div>

  <!-- Modal para adicionar folga -->
  <div class="modal fade" id="addFolgaModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Adicionar Folga</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form id="folga-form">
            <div class="mb-3">
              <label for="folga-colaborador" class="form-label">Colaborador</label>
              <select id="folga-colaborador" class="form-select" required></select>
            </div>
            <div class="mb-3">
              <label for="folga-data" class="form-label">Data da Folga (dd/mm/aaaa)</label>
              <input type="text" id="folga-data" class="form-control" placeholder="dd/mm/aaaa" required>
            </div>
            <button type="submit" class="btn btn-custom">Salvar Folga</button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal para adicionar lembrete -->
  <div class="modal fade" id="addLembreteModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Adicionar Lembrete</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form id="lembrete-form">
            <div class="mb-3">
              <label for="lembrete-data" class="form-label">Data do Lembrete (dd/mm/aaaa)</label>
              <input type="text" id="lembrete-data" class="form-control" placeholder="dd/mm/aaaa" required>
            </div>
            <div class="mb-3">
              <label for="lembrete-evento" class="form-label">Descrição do Evento</label>
              <input type="text" id="lembrete-evento" class="form-control" placeholder="Ex: Renovar ASO" required>
            </div>
            <button type="submit" class="btn btn-custom">Salvar Lembrete</button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <footer>
    AW;Code 2025 - Todos os direitos reservados | <a href="mailto:contato@bagam.com" style="color:#fff;text-decoration:underline;">Contato</a>
    <img src="Fotos Colaboradores/logo2.png" width="70" height="80">
  </footer>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script>

    if (sessionStorage.getItem('vb_autenticado') !== 'ok') {
  window.location.href = 'https://bagam-v.github.io/veja-bagam/pagina3/dudu (1).html';
}  
     // Lista de colaboradores (mantida do original)
    const collaborators = [
  {name:"AGEILSON",setor:"Operação",photo:"Fotos Colaboradores/ageilson.png",birthday:"09/11"},
  {name:"ALLAN",setor:"Operação",photo:"Fotos Colaboradores/allan.png",birthday:"12/06"},
  {name:"ALDERIR",setor:"Pintura",photo:"Fotos Colaboradores/alderir.jpeg",birthday:"04/02"},
  {name:"ANA CLÉZIA",setor:"CCO",photo:"Fotos Colaboradores/ana.jpeg",birthday:"20/11"},
  {name:"AUGUSTO",setor:"Manutenção",photo:"Fotos Colaboradores/augusto.png",birthday:"25/05"},
  {name:"CLEIRTON",setor:"Gerência",photo:"Fotos Colaboradores/cleirton.png",birthday:"12/05"},
  {name:"CRISTIANO",setor:"Operação",photo:"Fotos Colaboradores/cristiano.png",birthday:"15/04"},
  {name:"DANIEL",setor:"Conservação",photo:"Fotos Colaboradores/daniel.png",birthday:"04/09"},
  {name:"DANILO",setor:"Laboratório",photo:"Fotos Colaboradores/danilo.png",birthday:"12/10"},
  {name:"DOUGLAS",setor:"Operação",photo:"Fotos Colaboradores/douglas.jpeg",birthday:"23/12"},
  {name:"EDNILMA",setor:"Conservação",photo:"Fotos Colaboradores/nenem.jpg",birthday:"26/08"},
  {name:"EDUARDO",setor:"Liderança",photo:"Fotos Colaboradores/eduardo.png",birthday:"16/03"},
  {name:"ELTOM",setor:"Operação",photo:"Fotos Colaboradores/eltom.png",birthday:"11/08"},
  {name:"NALDO",setor:"Operação",photo:"Fotos Colaboradores/naldo.png",birthday:"28/10"},
  {name:"GABRIEL",setor:"Vigilância",photo:"Fotos Colaboradores/gabriel.png",birthday:"25/03"},
  {name:"GEDSON",setor:"Operação",photo:"Fotos Colaboradores/gedson.png",birthday:"03/06"},
  {name:"GLEISON",setor:"Operação",photo:"Fotos Colaboradores/gleison.png",birthday:"06/07"},
  {name:"HELINE",setor:"Administrativo",photo:"Fotos Colaboradores/heline.png",birthday:"06/11"},
  {name:"HILANA",setor:"CCO",photo:"Fotos Colaboradores/hilana.png",birthday:"24/06"},
  {name:"ISAIAS",setor:"Operação",photo:"Fotos Colaboradores/isaias.png",birthday:"29/03"},
  {name:"JOÃO VITOR",setor:"CCO",photo:"Fotos Colaboradores/joao.png",birthday:"12/05"},
  {name:"JUNIOR",setor:"Manutenção",photo:"Fotos Colaboradores/junior.jpeg",birthday:"16/11"},
  {name:"JULLY",setor:"Operação",photo:"Fotos Colaboradores/jully.png",birthday:"23/09"},
  {name:"LEANDRO",setor:"Vigilância",photo:"Fotos Colaboradores/leandro.jpeg",birthday:"25/02"},
  {name:"MARIA CLAUDIA",setor:"Administrativo",photo:"Fotos Colaboradores/claudia.jpg",birthday:"27/10"},
  {name:"NAILSON",setor:"Vigilância",photo:"Fotos Colaboradores/nailson.png",birthday:"03/11"},
  {name:"PETERSON",setor:"Laboratório",photo:"Fotos Colaboradores/peterson.png",birthday:"10/08"},
  {name:"RONILSON",setor:"Operação",photo:"Fotos Colaboradores/ronilson.png",birthday:"08/12"},
  {name:"SAMUEL",setor:"Conservação",photo:"Fotos Colaboradores/samuel.jpg",birthday:"28/08"},
  {name:"VALMIR",setor:"Vigilância",photo:"Fotos Colaboradores/valmir.jpg",birthday:"02/01"},
  {name:"VLADIMIR",setor:"Pintura",photo:"Fotos Colaboradores/vlad.jpg",birthday:"17/02"},
  {name:"WAGNER",setor:"CCO",photo:"Fotos Colaboradores/wagner.png",birthday:"10/05"},
  {name:"WENDERSON",setor:"TI",photo:"Fotos Colaboradores/wenderson.png",birthday:"08/08"},
  {name:"WILLIAM",setor:"SMS",photo:"Fotos Colaboradores/william.png",birthday:"01/04"}
];

// Dados de folgas e lembretes (armazenados em localStorage)
let folgas = JSON.parse(localStorage.getItem('folgas')) || [];
let lembretes = JSON.parse(localStorage.getItem('lembretes')) || [];

// Feriados municipais e estaduais específicos de Guamaré/RN
const localHolidays = [
      { day: 20, month: 0, year: 2025, name: "São Sebastião – Municipal" },
      { day: 7, month: 4, year: 2025, name: "Emancipação Política de Guamaré – Municipal" },
      { day: 15, month: 7, year: 2025, name: "Nossa Senhora dos Navegantes – Municipal" },
      { day: 3, month: 9, year: 2025, name: "Memória Dos Protomártires de Uruaçu e Cunhaú – Estadual (RN)" },
      { day: 8, month: 11, year: 2025, name: "Nossa Senhora da Conceição – Municipal" }
    ];
    function getLocalHoliday(day, month, year) {
      return localHolidays.find(h => h.day === day && h.month === month && h.year === year);
    }
    const holidays = [
      { day: 1, month: 0, name: "Confraternização Universal" },
      { day: 25, month: 1, name: "Carnaval" },
      { day: 29, month: 2, name: "Paixão de Cristo" },
      { day: 21, month: 3, name: "Tiradentes" },
      { day: 1, month: 4, name: "Dia do Trabalho" },
      { day: 7, month: 8, name: "Independência do Brasil" },
      { day: 12, month: 9, name: "Nossa Senhora Aparecida" },
      { day: 2, month: 10, name: "Finados" },
      { day: 15, month: 10, name: "Proclamação da República" },
      { day: 20, month: 10, name: "Consciência Negra" },
      { day: 25, month: 11, name: "Natal" }
    ];
    const monthNames = [
      "Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"
    ];
    function parseDateBR(str) {
      if (!str) return null;
      str = str.replace(/-/g, '/');
      const p = str.split('/');
      if (p.length < 3) return null;
      let d, m, y;
      if (p[0].length === 4) { y = p[0], m = p[1], d = p[2]; }
      else { d = p[0], m = p[1], y = p[2]; }
      return new Date(+y, +m-1, +d);
    }
    function formatDateBR(str) {
      if (!str) return "";
      str = str.replace(/-/g, '/');
      const p = str.split('/');
      let d, m, y;
      if (p.length < 2) return "";
      if (p.length === 2) { d = p[0], m = p[1], y = null; }
      else if (p[0].length === 4) { y = p[0], m = p[1], d = p[2]; }
      else { d = p[0], m = p[1], y = p[2]; }
      d = d.padStart(2,"0"); m = m.padStart(2,"0");
      if (y) { if (y.length === 2) y = '20'+y; return `${d}/${m}/${y}`; }
      return `${d}/${m}`;
    }
    function getMonthFromDate(str) {
      if (!str) return null;
      str = str.replace(/-/g, '/');
      const p = str.split('/');
      return p[1]?parseInt(p[1],10)-1:null;
    }
    function getDayFromDate(str) {
      if (!str) return null;
      str = str.replace(/-/g, '/');
      const p = str.split('/');
      return p[0]?parseInt(p[0],10):null;
    }
    function getYearFromDate(str) {
      if (!str) return null;
      str = str.replace(/-/g, '/');
      const p = str.split('/');
      return p[2]?parseInt(p[2],10):null;
    }
    // Checa se a folga ou lembrete está no mês/ano selecionado
    function isInMonth(dateStr, month, year) {
      const m = getMonthFromDate(dateStr);
      const y = getYearFromDate(dateStr);
      return m === month && y === year;
    }
    const monthSelect = document.getElementById("month-select"), yearSelect = document.getElementById("year-select");
    for(let i=0;i<12;i++){const opt=document.createElement("option");opt.value=i;opt.textContent=monthNames[i];monthSelect.appendChild(opt);}
    const currentYear = new Date().getFullYear();
    for(let y=currentYear;y<=currentYear+2;y++){const opt=document.createElement("option");opt.value=y;opt.textContent=y;yearSelect.appendChild(opt);}
    let selectedMonth = new Date().getMonth(), selectedYear = new Date().getFullYear();
    monthSelect.value = selectedMonth; yearSelect.value = selectedYear;
    document.getElementById("prev-month").onclick=()=>{selectedMonth--;if(selectedMonth<0){selectedMonth=11;selectedYear--;}updateAll();};
    document.getElementById("next-month").onclick=()=>{selectedMonth++;if(selectedMonth>11){selectedMonth=0;selectedYear++;}updateAll();};
    monthSelect.onchange=e=>{selectedMonth=parseInt(monthSelect.value,10);updateAll();};
    yearSelect.onchange=e=>{selectedYear=parseInt(yearSelect.value,10);updateAll();};
    function renderCalendar() {
      const calendarTitle = document.getElementById("calendar-title"), calendarGrid = document.getElementById("calendar-grid");
      calendarTitle.textContent=`${monthNames[selectedMonth]} ${selectedYear}`; calendarGrid.innerHTML="";
      ["Dom","Seg","Ter","Qua","Qui","Sex","Sáb"].forEach(day=>{
        const h=document.createElement("div");
        h.className="calendar-day header";
        h.textContent=day;
        calendarGrid.appendChild(h);
      });
      const firstDay=new Date(selectedYear,selectedMonth,1).getDay(),daysInMonth=new Date(selectedYear,selectedMonth+1,0).getDate(),
        folgaDays = folgas.filter(f => isInMonth(f.date, selectedMonth, selectedYear)).map(f => getDayFromDate(f.date)),
        lembreteDays = lembretes.filter(l => isInMonth(l.date, selectedMonth, selectedYear)).map(l => getDayFromDate(l.date));
      const holidaysInMonth = holidays.filter(h=>h.month===selectedMonth);
      for(let i=0;i<firstDay;i++){
        const e=document.createElement("div");
        e.className="calendar-day empty";
        calendarGrid.appendChild(e);
      }
      for(let day=1;day<=daysInMonth;day++){
        const d=document.createElement("div");
        d.className = "calendar-day";
        d.textContent = day;
        const holiday = holidaysInMonth.find(h=>h.day===day);
        const localHoliday = getLocalHoliday(day, selectedMonth, selectedYear);
        const isFolga = folgaDays.includes(day);
        const isLembrete = lembreteDays.includes(day);
        let tooltipText = "";
        if (isFolga || isLembrete) {
          d.className += " birthday"; // Reaproveitando estilo para folga/lembrete
          if (isFolga) {
            const folgasDay = folgas.filter(f => getDayFromDate(f.date) === day && isInMonth(f.date, selectedMonth, selectedYear)).map(f => collaborators.find(c => c.name === f.collab)?.name || f.collab).join(", ");
            tooltipText += `Folgas: ${folgasDay}<br>`;
          }
          if (isLembrete) {
            const lembretesDay = lembretes.filter(l => getDayFromDate(l.date) === day && isInMonth(l.date, selectedMonth, selectedYear)).map(l => l.event).join(", ");
            tooltipText += `Lembretes: ${lembretesDay}`;
          }
          d.innerHTML = day +
            `<div class="calendar-tooltip">${tooltipText}</div>`;
        } else if (localHoliday) {
          d.classList.add("local-holiday");
          d.innerHTML = day +
            `<div class="calendar-tooltip">${localHoliday.name}</div>`;
        } else if (holiday) {
          d.className += " holiday";
          d.innerHTML = day +
            `<div class="calendar-tooltip">${holiday.name}</div>`;
        }
        const isToday = 
          day === new Date().getDate() &&
          selectedMonth === new Date().getMonth() &&
          selectedYear === new Date().getFullYear();
        if (isToday) {
          d.classList.add("today");
        }
        calendarGrid.appendChild(d);
      }
    }
    function renderFolgaList(list, container) {
      container.innerHTML = list.length ? list.map(folga => {
        const colab = collaborators.find(c => c.name === folga.collab) || {name: folga.collab, setor: "N/D", photo: "https://via.placeholder.com/120x120?text=Colaborador"};
        const photoUrl = colab.photo || "https://via.placeholder.com/120x120?text=Colaborador";
        return `<div class="member-card">
          <i class="fas fa-user"></i>
          <img src="${photoUrl}" alt="${colab.name}" class="member-photo"/>
          <h3>${colab.name}</h3>
          <p><strong><i class="fas fa-building"></i> Setor:</strong> ${colab.setor || "N/D"}</p>
          <p><i class="fas fa-bed"></i> Folga em: ${formatDateBR(folga.date)}</p>
        </div>`;
      }).join("") : "<p>Nenhuma folga registrada no mês.</p>";
    }
    function renderLembreteList(list, container) {
      container.innerHTML = list.length ? list.map(lembrete => {
        return `<div class="member-card">
          <i class="fas fa-bell"></i>
          <h3>Lembrete</h3>
          <p><strong><i class="fas fa-calendar-day"></i> Data:</strong> ${formatDateBR(lembrete.date)}</p>
          <p><i class="fas fa-info-circle"></i> Evento: ${lembrete.event}</p>
        </div>`;
      }).join("") : "<p>Nenhum lembrete registrado no mês.</p>";
    }
    function updateAll(){
      renderCalendar();
      const folgaList = folgas.filter(f => isInMonth(f.date, selectedMonth, selectedYear));
      const lembreteList = lembretes.filter(l => isInMonth(l.date, selectedMonth, selectedYear));
      renderFolgaList(folgaList,document.getElementById("folga-list"));
      renderLembreteList(lembreteList,document.getElementById("lembrete-list"));
    }

    // Preenche setores únicos no filtro
function preencherSetoresFiltro() {
  const setores = [...new Set(collaborators.map(c => c.setor).filter(Boolean))].sort();
  const select = document.getElementById('filter-setor');
  select.innerHTML = '<option value="">Todos</option>' + setores.map(s => `<option value="${s}">${s}</option>`).join('');
}

// Mostra/esconde painel de filtro
document.getElementById('filter-btn').onclick = function() {
  preencherSetoresFiltro();
  const panel = document.getElementById('filter-panel');
  // Alterna visibilidade ao clicar no botão
  panel.style.display = (panel.style.display === 'block') ? 'none' : 'block';
  document.getElementById('filter-resultado').innerHTML = '';
};
document.getElementById('filter-fechar').onclick = function() {
  document.getElementById('filter-panel').style.display = 'none';
  document.getElementById('filter-resultado').innerHTML = '';
};

// Adiciona aviso de filtro ativo e botão para limpar
function mostrarAvisoFiltro(filtrados) {
  let aviso = document.getElementById('aviso-filtro');
  if (!aviso) {
    aviso = document.createElement('div');
    aviso.id = 'aviso-filtro';
    aviso.style.position = 'fixed';
    aviso.style.top = '70px';
    aviso.style.left = '50%';
    aviso.style.transform = 'translateX(-50%)';
    aviso.style.background = '#047562';
    aviso.style.color = '#fff';
    aviso.style.padding = '12px 28px';
    aviso.style.borderRadius = '10px';
    aviso.style.boxShadow = '0 2px 12px #0002';
    aviso.style.zIndex = '3000';
    aviso.style.fontWeight = 'bold';
    aviso.style.fontSize = '1.12rem';
    aviso.style.display = 'flex';
    aviso.style.alignItems = 'center';
    aviso.style.gap = '18px';
    aviso.innerHTML = `<span><i class="fas fa-filter"></i> Filtro ativo (${filtrados.length} colaborador${filtrados.length===1?'':'es'})</span>
      <button id="btn-limpar-filtro" class="btn btn-outline-light btn-sm" style="font-weight:600;"><i class="fas fa-undo"></i> Limpar filtro</button>`;
    document.body.appendChild(aviso);
    document.getElementById('btn-limpar-filtro').onclick = function() {
      limparFiltro();
    };
  } else {
    aviso.querySelector('span').innerHTML = `<i class="fas fa-filter"></i> Filtro ativo (${filtrados.length} colaborador${filtrados.length===1?'':'es'})`;
  }
  aviso.style.display = 'flex';
}

function esconderAvisoFiltro() {
  const aviso = document.getElementById('aviso-filtro');
  if (aviso) aviso.style.display = 'none';
}

// Função para limpar filtro e restaurar lista completa
function limparFiltro() {
  document.getElementById('filter-setor').value = '';
  document.getElementById('filter-nome').value = '';
  document.getElementById('filter-folgas').checked = false;
  esconderAvisoFiltro();
  updateAll();
  document.getElementById('filter-panel').style.display = 'none';
  document.getElementById('filter-resultado').innerHTML = '';
}

// Filtra e mostra resultado em todos os painéis
document.getElementById('filter-aplicar').onclick = function() {
  const setor = document.getElementById('filter-setor').value.trim();
  const nome = document.getElementById('filter-nome').value.trim().toLowerCase();
  const soFolgas = document.getElementById('filter-folgas').checked;

  let filtrados = collaborators.filter(c => {
    let ok = true;
    if (setor) ok = ok && c.setor === setor;
    if (nome) ok = ok && c.name.toLowerCase().includes(nome);
    return ok;
  });

  const folgaList = folgas.filter(f => isInMonth(f.date, selectedMonth, selectedYear) && filtrados.some(c => c.name === f.collab) && (!soFolgas || true)); // Adaptado para folgas
  const lembreteList = lembretes.filter(l => isInMonth(l.date, selectedMonth, selectedYear));

  renderFolgaList(folgaList,document.getElementById("folga-list"));
  renderLembreteList(lembreteList,document.getElementById("lembrete-list"));

  // Fecha o painel de filtro após aplicar
  document.getElementById('filter-panel').style.display = 'none';
  document.getElementById('filter-resultado').innerHTML = '';

  // Mostra aviso de filtro ativo
  mostrarAvisoFiltro(filtrados);

  // Leva o usuário até o painel de colaboradores filtrados
  document.getElementById('folga-list-section').scrollIntoView({ behavior: 'smooth' });
};

// Limpar filtro também pelo botão do painel
document.getElementById('filter-limpar').onclick = function() {
  limparFiltro();
};
    updateAll();
    document.getElementById("toggleDark")?.addEventListener("click",function(){
      document.body.classList.toggle("dark-mode");
      document.querySelector("footer").classList.toggle("dark-mode");
      document.querySelector(".container").classList.toggle("dark-mode");
    });
    
function showNotification(msg, icon = "fa-info-circle", color = "#047562") {
  // Cria um ID único para cada notificação
  const notifId = 'auto-notification-' + Math.random().toString(36).substr(2, 6);
  const notif = document.createElement('div');
  notif.id = notifId;
  notif.style.position = 'fixed';
  notif.style.top = '18px';
  notif.style.left = '50%';
  notif.style.transform = 'translateX(-50%)';
  notif.style.background = color;
  notif.style.color = '#fff';
  notif.style.padding = '13px 32px';
  notif.style.borderRadius = '12px';
  notif.style.boxShadow = '0 2px 16px #0002';
  notif.style.zIndex = '4000';
  notif.style.fontWeight = 'bold';
  notif.style.fontSize = '1.13rem';
  notif.style.display = 'flex';
  notif.style.alignItems = 'center';
  notif.style.gap = '16px';
  notif.innerHTML = `<i class="fas ${icon}" style="font-size:1.3em;"></i> <span>${msg}</span>
    <button id="close-notif-${notifId}" class="btn btn-outline-light btn-sm" style="margin-left:18px;"><i class="fas fa-times"></i></button>`;
  document.body.appendChild(notif);
  document.getElementById(`close-notif-${notifId}`).onclick = function() {
    if (notif) notif.remove();
  };
  // Fecha automaticamente após 12 segundos
  setTimeout(() => {
    if (document.getElementById(notifId)) {
      notif.style.display = 'none';
      notif.remove();
    }
  }, 12000);
}

// Chama notificações automáticas ao abrir
function checkAutoNotifications() {
  const today = new Date();
  const todayMonth = today.getMonth();
  const todayDay = today.getDate();
  const todayYear = today.getFullYear();

  // Folgas hoje
  const folgasHoje = folgas.filter(f =>
    getMonthFromDate(f.date) === todayMonth &&
    getDayFromDate(f.date) === todayDay &&
    getYearFromDate(f.date) === todayYear
  );
  if (folgasHoje.length) {
    showNotification(
      `Hoje há folgas para: ${folgasHoje.map(f=>f.collab).join(', ')}`,
      "fa-bed",
      "#ef6c00"
    );
  }

  // Lembretes hoje
  const lembretesHoje = lembretes.filter(l =>
    getMonthFromDate(l.date) === todayMonth &&
    getDayFromDate(l.date) === todayDay &&
    getYearFromDate(l.date) === todayYear
  );
  if (lembretesHoje.length) {
    showNotification(
      `Lembretes de hoje: ${lembretesHoje.map(l=>l.event).join(', ')}`,
      "fa-bell",
      "#d81c1c"
    );
  }
}
checkAutoNotifications();
updateAll();

    // Preenche select de colaboradores no modal de folga
    const folgaColabSelect = document.getElementById('folga-colaborador');
    collaborators.forEach(c => {
      const opt = document.createElement('option');
      opt.value = c.name;
      opt.textContent = c.name;
      folgaColabSelect.appendChild(opt);
    });

    // Abrir modais
    document.getElementById('add-folga-btn').onclick = () => new bootstrap.Modal(document.getElementById('addFolgaModal')).show();
    document.getElementById('add-lembrete-btn').onclick = () => new bootstrap.Modal(document.getElementById('addLembreteModal')).show();

    // Salvar folga
    document.getElementById('folga-form').onsubmit = e => {
      e.preventDefault();
      const collab = document.getElementById('folga-colaborador').value;
      const date = document.getElementById('folga-data').value;
      if (collab && date) {
        folgas.push({collab, date});
        localStorage.setItem('folgas', JSON.stringify(folgas));
        updateAll();
        bootstrap.Modal.getInstance(document.getElementById('addFolgaModal')).hide();
        showNotification('Folga adicionada com sucesso!', 'fa-check', '#38d397');
      }
    };

    // Salvar lembrete
    document.getElementById('lembrete-form').onsubmit = e => {
      e.preventDefault();
      const date = document.getElementById('lembrete-data').value;
      const event = document.getElementById('lembrete-evento').value;
      if (date && event) {
        lembretes.push({date, event});
        localStorage.setItem('lembretes', JSON.stringify(lembretes));
        updateAll();
        bootstrap.Modal.getInstance(document.getElementById('addLembreteModal')).hide();
        showNotification('Lembrete adicionado com sucesso!', 'fa-check', '#38d397');
      }
    };

  </script>

</body>

</html>
